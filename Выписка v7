ТаблУчета = СоздатьОбъект("ТаблицаЗначений");
	ТаблУчета.НоваяКолонка("Документ", "Документ");
	ТаблУчета.НоваяКолонка("НомерСтрокиДок", "Число");
	ТаблУчета.НоваяКолонка("ДатаНомерДок", "Строка");
	ТаблУчета.НоваяКолонка("СодержОперации");
	ТаблУчета.НоваяКолонка("Описание");
	ТаблУчета.НоваяКолонка("Доходы");
	ТаблУчета.НоваяКолонка("Расходы");  
	ТаблУчета.НоваяКолонка("ДоходыБУ");
	ТаблУчета.НоваяКолонка("РасходыБУ");
	ТаблУчета.НоваяКолонка("ДоходыЕНВД");
	ТаблУчета.НоваяКолонка("НомерКвартала", "Число", 1, 0);
	ТаблУчета.НоваяКолонка("НДС");
	ТаблУчета.НоваяКолонка("Валюта");
	ТаблУчета.НоваяКолонка("ВалСумма");
	ТаблУчета.НоваяКолонка("Счетчик","Число");
    Счетчик = 1;
	
	Док=создатьобъект("Документ.Выписка");
	Док.ВыбратьДокументы(Дата1,Дата2);
	Пока Док.ПолучитьДокумент() = 1 Цикл
		если док.Проведен()<>1 тогда продолжить конецесли;
		док.ВыбратьСтроки();НомерСтроки=0;
		пока док.ПолучитьСтроку()=1 цикл  
			НомерСтроки=НомерСтроки+1;
			состояние("Обработка выписки №"+док.НомерДок+" от "+док.ДатаДок+", строка "+НомерСтроки);
			Доходы = 0;
			Расходы = 0; 
			ДоходыБУ = 0;
			РасходыБУ = 0;                                  
			ДоходыЕНВД = 0;
			//если док.ВидДвижения.Наименование="Прочие поступления"тогда
			//	если док.КоррСчет<>СчетПоКоду("76.3") тогда
			//		продолжить;
			//	конецесли;	
			//иначе
			//	если(док.КоррСчет<>СчетПоКоду("76.5"))
			//	   и(док.КоррСчет<>СчетПоКоду("68.1"))
			//	   и(док.КоррСчет<>СчетПоКоду("44.3"))
			//	   и(док.КоррСчет<>СчетПоКоду("69.11"))
			//	   и(док.КоррСчет<>СчетПоКоду("69.2.2"))
			//	   и(док.КоррСчет<>СчетПоКоду("69.2.3"))
			//	тогда
			//		продолжить;
			//	конецесли;	
			//конецесли;	
			если док.Приход<>0 тогда
				// доходы 
				если(док.КоррСчет<>СчетПоКоду("62.1"))
				   и(док.КоррСчет<>СчетПоКоду("62.2"))
				тогда     
					продолжить;
				конецесли;	
			иначе        
				// расходы
				если(док.КоррСчет<>СчетПоКоду("60.1"))
				тогда     
					продолжить;
				конецесли;
				если КагентВСписке(док.Субконто1)=0 тогда
					продолжить;
				конецесли;	
			конецесли;	
			ДоходыБУ=док.Приход;
			РасходыБУ=док.Расход;
			Доходы=ДоходыБУ;
			Расходы=РасходыБУ;
			
			ТаблУчета.НоваяСтрока();
			ТаблУчета.Документ = док.ТекущийДокумент();
			ТаблУчета.НомерСтрокиДок = НомерСтроки;
			ТаблУчета.ДатаНомерДок   = "№"+док.НомерДокВходящий+" от "+док.ДатаДокВходящий;
			ТаблУчета.СодержОперации = (док.НазначениеПлатежа);
			Если лев(сокрлп(нрег(ТаблУчета.СодержОперации)),15)="оплата за товар" тогда
				ТаблУчета.СодержОперации="Оплата за товар ("+док.Субконто1+")";
			конецесли;	
			ТаблУчета.Описание = "";
			ТаблУчета.Доходы  = Доходы;
			ТаблУчета.Расходы = Расходы;
			ТаблУчета.ДоходыБУ  = ДоходыБУ;
			ТаблУчета.ДоходыЕНВД  = ДоходыЕНВД;
			ТаблУчета.РасходыБУ = РасходыБУ;
			ТаблУчета.НомерКвартала = НомерКвартала(док.ТекущийДокумент().ДатаДок);
	        ТаблУчета.НДС = НДС; 
			ТаблУчета.Валюта = Валюта;
			ТаблУчета.ВалСумма = ВалСумма; 
			ТаблУчета.Счетчик = Счетчик;
			Счетчик = Счетчик + 1;     
		конеццикла;	
	КонецЦикла; 
	//*************************************************************************************************************
	//**
	//**
	ТаблУчета2 = СоздатьОбъект("ТаблицаЗначений");
	ТаблУчета2.НоваяКолонка("Документ", "Документ");
	ТаблУчета2.НоваяКолонка("НомерСтрокиДок", "Число");
	ТаблУчета2.НоваяКолонка("ДатаНомерДок", "Строка");
	ТаблУчета2.НоваяКолонка("СодержОперации");
	ТаблУчета2.НоваяКолонка("Описание");
	ТаблУчета2.НоваяКолонка("Доходы");
	ТаблУчета2.НоваяКолонка("Расходы");  
	ТаблУчета2.НоваяКолонка("ДоходыБУ");
	ТаблУчета2.НоваяКолонка("РасходыБУ");
	ТаблУчета2.НоваяКолонка("ДоходыЕНВД");
	ТаблУчета2.НоваяКолонка("НомерКвартала", "Число", 1, 0);
	ТаблУчета2.НоваяКолонка("НДС");
	ТаблУчета2.НоваяКолонка("Валюта");
	ТаблУчета2.НоваяКолонка("ВалСумма");
	ТаблУчета2.НоваяКолонка("Счетчик","Число");
    //Счетчик = 1;
	Док2 = Создатьобъект("Документ.БухгалтерскаяСправка");
	Док2.ВыбратьДокументы(Дата1,Дата2);
	Пока Док2.ПолучитьДокумент() = 1 Цикл
		Если Док2.Проведен()<>1 Тогда 
			Продолжить; 
		КонецЕсли;
		Док2.ВыбратьСтроки();
		//НомерСтроки=0;
		Пока Док2.ПолучитьСтроку()=1 цикл  
			НомерСтроки = НомерСтроки + 1;
			Состояние("Обработка бухгалтерской справки №"+док2.НомерДок+" от "+док2.ДатаДок+", строка "+НомерСтроки);
			Доходы = 0;
			Расходы = 0; 
			ДоходыБУ = 0;
			РасходыБУ = 0;                                  
			ДоходыЕНВД = 0;
				Если ((Док2.СчетДт = СчетПоКоду("51")) и (Док2.СчетКт = СчетПоКоду("62.1")) и (Док2.Сумма <> 0)) Тогда
	                ДоходыБУ = Док2.Сумма; 
					Доходы = ДоходыБУ;
					ТаблУчета2.НоваяСтрока();
					ТаблУчета2.Документ = Док2.ТекущийДокумент();
					ТаблУчета2.НомерСтрокиДок = НомерСтроки;
					ТаблУчета2.ДатаНомерДок   = "№"+ Док2.НомерДок+" от "+ Док2.ДатаДок;
			       	ТаблУчета2.СодержОперации = (Док2.СубконтоКт1); 
				   	ТаблУчета2.Описание = "";   
					ТаблУчета2.Доходы  = Доходы;
					ТаблУчета2.Расходы = Расходы;
					ТаблУчета2.ДоходыБУ  = ДоходыБУ;
					ТаблУчета2.ДоходыЕНВД  = ДоходыЕНВД;
					ТаблУчета2.РасходыБУ = РасходыБУ;
					ТаблУчета2.НомерКвартала = НомерКвартала(док2.ТекущийДокумент().ДатаДок);
			        ТаблУчета2.НДС = НДС; 
					ТаблУчета2.Валюта = Валюта;
					ТаблУчета2.ВалСумма = ВалСумма; 
					ТаблУчета2.Счетчик = Счетчик;
					Счетчик = Счетчик + 1; 
				КонецЕсли;
		КонецЦикла;   	
	КонецЦикла;	
